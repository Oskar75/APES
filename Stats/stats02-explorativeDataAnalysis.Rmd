---
output:
  html_document:
    keep_md: yes
    fig_width: 5
---
---
layout: page
title: Explorative data analysis
category: stats
subcategory: Basic concepts
---

Explorative data analysis
===
```{r}
library(knitr)
opts_knit$set(global.par=TRUE) 
opts_chunk$set(cache.extra = rand_seed,fig.align='center')
set.seed(2)
```
For more details about plotting, please visit: https://github.com/biometry/APES/blob/master/R/R40-plottingInR.md

We will classify here the different plot methods according to their suitability to the variable analysis

# Categorical Variables
Categorical variables can have two or more categories with no ordering among the categories.  
For example, eye color is a categorical variable consisting in 4 categories (blue, green, black or brown) and there is no particular order for the different categories.   

We will explain the most appropiate methods to explore categorical variables below:

## Bar charts

Bar charts are appropiate to summarize categorical variables distributions
```{r}
attach (mtcars)
head(mtcars)
```
we substract the variable Transmission (0 = automatic, 1 = manual) with "$" from the dataset 
```{r}
fam= mtcars$fam=factor(mtcars$am, levels=c(0,1), labels=c("automatic","manual"))
head(mtcars)
```

Frequency table of the Transmission variable, how many cars have automatic and how many manual transmission
```{r}
table(fam)
count=table(fam) 
count
```

% frequencies calculation
```{r}
percent=table(fam)/length(fam)
percent
```

Graphic representation of both with barplots
```{r}
barplot(count)
barplot(percent)
```

We add a title and x/y labels
```{r}
barplot(percent,main="the title", xlab="transmission",ylab="%",las=1,ylim=c(0,1), names.arg=c("auto transm", "manual transm") )
```

# Numerical Variables
On numerical variables, on the other hand, there is an order among the variables.  
An example could be, the scores achieve by a group of student on a test, from 1 to 5. 
We could evaluate the success of the students depending on their scores.

## Boxplot 

Boxplots are appropiate to summarize numerical variables distributions
```{r}
summary(mpg)
quantile(mpg)
quantile(mpg,probs=c(0,0.20,0.40,0.60,0.80,1))
```

Boxplot of the variable mpg (miles per galon)
```{r}
boxplot(mpg,main="title", ylab="mpg", ylim=c(0,50), las=1)
```

Boxplot of the variable mpg depending of the transmission type
```{r}
boxplot(mpg~fam, main="mpg by transmission")
```

Boxplot of the mpg for the cars with automatic transmission
```{r}
boxplot(mpg[fam=="automatic"],xlab="automatic")
```

## Histograms 

Histograms are appropiate to summarize numerical variables distributions
```{r}
hist(mpg)

hist(mpg,freq=FALSE,main="my histogram") #instead of counting the number of datapoints per bin, R can give the probability densities by using freq=FALSE 

hist(mpg,prob=TRUE,ylim=c(0,0.1)) #prob=T changes the y-axis from frequency counts to probability (to create density curves)

lines(density(mpg))  #add a density curve
lines(density(mpg),col="red",lwd=3)
hist(mpg,breaks=seq(10,36,by=2),las=1)
```

## Stem and Leaf Plots 

Stem and Leaf plots are appropiate to summarize numerical variables distributions (low sample size)
```{r}
stem(mpg)   
```
Write ?stem for more info
There are 2 obs 10.4
There is one obs 32.4 and one 32.9
 
## Scatterplots 

Scatterplots are appropiate to summarize the relation between two numerical variables 

Relation ship between horsepower hp and consumption mpg
```{r}
plot(mpg~hp) # y~x
plot(hp, mpg) # x,y
```

We can plot it editing some features, such as the color, size of the symbols, or the range of the x axis
```{r}
plot(hp, mpg,xlab = "Gross horsepower", ylab="Miles/(US) gallon",las=1,col="red", xlim=c(0,400), cex =2 )  #cex (plotting characters size times 2)
```

Now we will change the symbol type and add a linear regression, indicating the line type and width 
```{r}
plot(hp, mpg,xlab = "Gross horsepower", ylab="Miles/(US) gallon",las=1,col="red", xlim=c(0,400), pch=8)  #pch (symbol type)
abline(lm(mpg~hp),col="blue",lwd=5,lty=3) 
```

Here we can appreciate the different types of symbols available
```{r}
x = 1:20
plot(x,pch=x,cex=3)
```


# Summary statistics

The summary statistics tries to give the largest amount of information possible of the data in the simplest and quickest way possible.
This usually includes mean, median, minimum and maximum value, standard deviation, etc.

## For a categorical variable, like "fam"
```{r}
table(fam)

table(fam)/length(fam)
```

Contingency table (2-way table)
```{r}
table(mpg,fam) #vertical table

table(fam,mpg) # horizontal table
```

## For a numerical variable, like "mpg"
```{r}
mean(mpg)
summary(mpg)
sd(mpg) #standard deviation
var(mpg) #variance
sqrt(var(mpg)) # = to sd
sd(mpg)^2 # = to variance
max(mpg)

tapply(mpg,fam,mean)
tapply(mpg,list(fam,gear),mean)
```
